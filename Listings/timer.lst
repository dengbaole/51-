C51 COMPILER V9.54   TIMER                                                                 11/04/2022 08:53:06 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: D:\app\keil51\C51\BIN\C51.EXE user\timer.c COMPACT OPTIMIZE(8,SPEED) BROWSE INCDIR(.\user;D:\app\ke
                    -il51\C51\INC\Atmel) DEBUG OBJECTEXTEND PRINT(.\Listings\timer.lst) TABS(2) OBJECT(.\Objects\timer.obj)

line level    source

   1          #include "timer.h"
   2          #include <REGX52.H>
   3          #include "uart.h"
   4          #include "nixie.h"
   5          #include "beep.h"
   6          
   7          
   8          /****************************************************************************************************
   9          //说明:51单片机定时器使用说明
  10          //接口定义:
  11          //位寻址: 
  12          *****************************************************************************************************/
  13          unsigned int T0Countms;
  14          unsigned int T0Count_100ms;
  15          
  16          
  17                                                                                                         
  18          
  19          
  20          void timer0_init(void)
  21          {
  22   1          TMOD &= 0xF0;   //设置定时器模式
  23   1        TMOD |= 0x01;   //设置定时器模式
  24   1        TL0 = 0x18;   //设置定时初值
  25   1        TH0 = 0xFC;   //设置定时初值
  26   1        TF0 = 0;    //清除TF0标志
  27   1        TR0 = 1;    //定时器0开始计时
  28   1      
  29   1      
  30   1          //中断配置
  31   1          ET0 = 1;
  32   1          EA = 1 ;
  33   1          PT0=0;
  34   1      }
  35          
  36          /**
  37            * @brief  定时器1中断（被串口占用）
  38            * @param  无
  39            * @retval 无
  40            */
  41          void timer1_init(void)   //1000微秒@12.000MHz
  42          {
  43   1        TMOD &= 0x0F;   //设置定时器模式
  44   1          TMOD |= 0x10;
  45   1        TL1 = 0x20;   //设置定时初值
  46   1        TH1 = 0xD1;   //设置定时初值
  47   1        TF1 = 0;    //清除TF1标志
  48   1        TR1 = 1;    //定时器1开始计时
  49   1      
  50   1          //中断配置
  51   1          ET1 = 1;
  52   1          EA = 1 ;
  53   1          PT1=0;
  54   1      }
C51 COMPILER V9.54   TIMER                                                                 11/04/2022 08:53:06 PAGE 2   

  55          
  56          
  57          
  58          void timer2_init(void)  //1微秒@12.000MHz
  59          {
  60   1          T2MOD = 0;        //初始化模式寄存器
  61   1        T2CON = 0;        //初始化控制寄存器
  62   1          TL2 = 64535/256;  //设置定时初值
  63   1        TH2 = 64535%256;  //设置定时初值
  64   1        TR2 = 1;        //定时器2开始计时
  65   1      
  66   1          //中断配置
  67   1          ET2 = 1;
  68   1          EA = 1 ;
  69   1          PT2=0;
  70   1      }
  71          
  72          //定时器0中断函数(每1ms进入一次中断函数)
  73          void Timer0_ISR() interrupt 1
  74          {
  75   1      //    if(FreqTable[FreqSelect]) //如果不是休止符
  76   1      //  {
  77   1      //    /*取对应频率值的重装载值到定时器*/
  78   1      //    TL0 = FreqTable[FreqSelect]%256;    //设置定时初值
  79   1      //    TH0 = FreqTable[FreqSelect]/256;    //设置定时初值
  80   1      //    Buzzer=!Buzzer;                     //翻转蜂鸣器IO口
  81   1      //  }
  82   1      }
  83          
  84          
  85          void Timer1_ISR() interrupt 3
  86          {
  87   1          //
  88   1      }
  89          
  90          
  91          void Timer2_ISR() interrupt 5
  92          {
  93   1          //TF2 = 0;
  94   1          //设置蜂鸣器频率
  95   1      //   if(FreqTable[FreqSelect])  //如果不是休止符
  96   1      //    {
  97   1      //      /*取对应频率值的重装载值到定时器*/
  98   1      //      TL0 = FreqTable[FreqSelect]%256;    //设置定时初值
  99   1      //      TH0 = FreqTable[FreqSelect]/256;    //设置定时初值
 100   1      //      Buzzer=!Buzzer;                   //翻转蜂鸣器IO口
 101   1      //    }
 102   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     69    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =      4    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
